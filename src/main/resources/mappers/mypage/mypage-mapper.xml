<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ss.sns.mypage.mapper.MypageMapper">

<update id="profileModify" parameterType="map">
	UPDATE MEMBER
	SET MEMBER_NICKNAME = #{nickname},
	MEMBER_IMG = #{img}
	WHERE MEMBER_EMAIL = #{email}
</update>

<select id="selectBoardTotalCount" parameterType="int" resultType="int">
	SELECT COUNT(*) FROM BOARD WHERE MEMBER_NO = #{member_no}
</select>

<select id="selectMyBoardList" parameterType="map" resultType="MyBoardDTO">
	SELECT MBP.BOARD_NO, MBP.BOARD_TYPE, MBP.BOARD_TITLE, MBP.CREATE_DATE, MBP.BOARD_HIT, MBP.BOARD_KIND
	FROM (SELECT ROWNUM RNUM, BM.* 
	FROM (SELECT * FROM BOARD WHERE MEMBER_NO = #{member_no} ORDER BY CREATE_DATE) BM )MBP
	WHERE RNUM BETWEEN #{startNo} and #{endNo}

</select>


    <select id="selectTripsByMemberNo" resultType="TripDTO">
        SELECT t.trip_no, t.trip_title, t.trip_start, t.trip_end, t.place_photo_url
        FROM member m
        JOIN member_trip mt ON m.member_no = mt.member_no
        JOIN trip t ON mt.trip_no = t.trip_no
        WHERE m.member_no = #{memberNo}
    </select>


<select id="selectMyLikeBoardList" parameterType="map" resultType="MyBoardDTO">

SELECT MBL.BOARD_NO,MBL.BOARD_TYPE, MBL.MEMBER_NICKNAME, MBL.BOARD_TITLE,MBL.CREATE_DATE, MBL.BOARD_HIT, MBL.BOARD_KIND
    FROM (
        SELECT ROWNUM RNUM, BM.* 
        FROM (
            SELECT B.*, M.MEMBER_NICKNAME FROM BOARD B
            JOIN MEMBER M ON (M.MEMBER_NO = B.MEMBER_NO)
            JOIN LIKE2 L ON (B.BOARD_NO = L.BOARD_NO)
            WHERE L.MEMBER_NO = #{member_no} ORDER BY CREATE_DATE
        ) BM 
    )MBL
	WHERE RNUM BETWEEN #{startNo} and #{endNo}
	
</select>



</mapper>